# AI-функции

Искусственный интеллект для повышения продуктивности.

## AI-разбиение задач

### Как это работает

1. Пользователь нажимает "Разбить на шаги с ИИ"
2. Система определяет текущее настроение/энергию
3. Выбирается стратегия декомпозиции
4. OpenAI генерирует 5-8 подзадач
5. Подзадачи сохраняются и отображаются

### Стратегии декомпозиции

#### Micro (Низкая энергия)
- **Шаги**: 5-10 минут каждый
- **Максимум**: 8 подзадач
- **Перерыв**: каждые 2 подзадачи
- **Для кого**: настроение 1, энергия 1-2

#### Gentle (Низкая-средняя энергия)
- **Шаги**: 10-15 минут
- **Максимум**: 6 подзадач
- **Перерыв**: каждые 3 подзадачи
- **Для кого**: настроение 2, энергия 2-3

#### Careful (Средняя энергия)
- **Шаги**: 10-15 минут
- **Максимум**: 6 подзадач
- **Перерыв**: каждые 2 подзадачи
- **Для кого**: настроение 3, энергия 3

#### Standard (Нормальная энергия)
- **Шаги**: 15-25 минут
- **Максимум**: 5 подзадач
- **Перерыв**: каждые 4 подзадачи
- **Для кого**: настроение 4-5, энергия 4-5

### Промпт для AI

Система отправляет в OpenAI:
- Название задачи
- Описание (если есть)
- Выбранную стратегию
- Инструкции по формату

AI возвращает:
- Список подзадач с названиями
- Оценку времени для каждой
- Порядок выполнения

### Fallback

Если OpenAI недоступен:
- Используется правило-based разбиение
- Задача делится на стандартные шаги
- Время оценивается по эвристикам

---

## Классификация задач

### Автоматическая классификация

При создании задачи AI определяет:

#### Тип задачи
| Тип | Описание | Примеры ключевых слов |
|-----|----------|----------------------|
| creative | Творческие | дизайн, создать, идея |
| analytical | Аналитические | анализ, отчёт, данные |
| communication | Общение | позвонить, встреча, написать |
| physical | Физические | спорт, уборка, прогулка |
| learning | Обучение | учить, курс, читать |
| planning | Планирование | план, организовать, список |
| coding | Программирование | код, баг, разработка |
| writing | Письменные | статья, документ, текст |

#### Оптимальное время
| Время | Описание |
|-------|----------|
| morning | Утро (6-12) — для концентрации |
| afternoon | День (12-18) — для рутины |
| evening | Вечер (18-22) — для отдыха и учёбы |
| night | Ночь (22-6) — для творчества |

### Использование классификации

1. **Умная сортировка**
   - +30 очков если время совпадает
   - +20 очков если тип в избранном

2. **Рекомендации**
   - Подсказки по оптимальному времени
   - Группировка похожих задач

---

## Советник по приоритетам

### Когда используется

При переносе задачи 2+ раза система:
1. Анализирует задачу
2. Определяет важность
3. Рекомендует повышение приоритета

### Логика повышения

| Переносов | Действие |
|-----------|----------|
| 2 | Проверка необходимости |
| 3+ | Low → Medium |
| 3+ | Medium → High |

### Факторы оценки
- Количество переносов
- Текущий приоритет
- Тип задачи
- История пользователя

---

## Персонализация

### Данные для AI

Из профиля пользователя:
- Продуктивное время
- Любимые типы задач
- Личные вызовы
- Описание работы
- Цели

### Адаптация

AI учитывает:
- **Настроение** → размер шагов
- **Энергию** → частота перерывов
- **Время суток** → сортировка задач
- **Предпочтения** → рекомендации

---

## Технические детали

### Модель
- **GPT-5-mini-2025-08-07**
- `reasoning_effort: "minimal"`
- Максимум 500 токенов ответа

### Формат ответа
```json
{
  "subtasks": [
    {
      "title": "Название шага",
      "estimated_minutes": 15,
      "order": 1
    }
  ]
}
```

### Обработка ошибок
- Таймаут: 30 секунд
- При ошибке: fallback к правилам
- Логирование всех запросов
